 phi_map: 
          25          25          25          25 : len_i
           1          26          51          76 : k_i
          -1          25          50          75 : upper_i
          26          51          76          -1 : lower_i
